version: 2.1

commands:
  install-hclq:
    steps:
      # see https://github.com/mattolenik/hclq#auto-updating-script
      - run: |
          # Download the script
          curl -sSLo install.sh https://install.hclq.sh

          # Inspect the script before executing, as is good practice
          # for code from the internet, regardless of trust!
          less install.sh

          # Run it!
          sh install.sh

jobs:
  hclq:
    docker:
      - image: cimg/go:1.18.2
    resource_class: medium
    steps:
      - checkout
      - install-hclq
      - run:
          name: HCLQ get
          command: |
            cat example.tf | hclq get 'data.foo.bar'
      - run:
          name: HCLQ get
          command: |
            cat example.tf | hclq set 'data.*.bar' "hogehoge"

workflows:
  main:
    jobs:
      - hclq
